<!--
@element date-select

`<date-select>` is a date selector widget inspired inspired by the date picker in iOS

Example usage:

    <date-select year="{{ year }}" month="{{ month }} year="{{ year }}"></date-select>

-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../wheel-select/wheel-select.html">

<polymer-element name="date-select" layout horizontal center-justified>

<template>
    <style>
        :host {
            display: block;
            perspective: 1000px;
            text-align: center;
            min-width: 235px;
        }

        wheel-select {
            perspective: 0;
        }

        wheel-select::shadow .option {
            padding: 0 10px;
        }

        .days::shadow .option {
            text-align: right;
        }

        .months::shadow .option, .years::shadow .option {
            text-align: left;
        }

        .days {
            width: 60px;
        }

        .months {
            min-width: 100px;
            max-width: 150px;
        }

        .years {
            width: 75px;
        }
    </style>

    <wheel-select options="{{ days }}" value="{{ day }}" class="days"></wheel-select>
    <wheel-select options="{{ months }}" value="{{ month }}" class="months" flex></wheel-select>
    <wheel-select options="{{ years }}" value="{{ year }}" class="years"></wheel-select>

</template>

<script>
(function() {
    'use strict';

    Polymer({

        // TODO: Find a way to provide localized month names
        months: [
            { label: 'January', value: 0 },
            { label: 'February', value: 1 },
            { label: 'March', value: 2 },
            { label: 'April', value: 3 },
            { label: 'May', value: 4 },
            { label: 'June', value: 5 },
            { label: 'Juli', value: 6 },
            { label: 'August', value: 7 },
            { label: 'September', value: 8 },
            { label: 'October', value: 9 },
            { label: 'November', value: 10 },
            { label: 'Dezember', value: 11 },
        ],

        publish: {
            /**
             * @attribute day
             * The selected day. If not specified, defaults to the current day.
             */
            day: 0,
            /**
             * @attribute month
             * The selected month. If not specified, defaults to the current month.
             * NOTE: This value is 0-based to be consistent with the native `Date` object.
             * I.e. `0` corresponds to January, `1` corresponds to February and so on.
             */
            month: 0,
            /**
             * @attribute year
             * The selected year. If not specified, defaults to the current year.
             */
            year: 0
        },

        computed: {
            days: 'daysInMonth(month, year)'
        },

        created: function() {
            var currDate = new Date();
            var currYear = currDate.getFullYear();
            var years = [];

            for (var y = currYear; y < currYear + 20; y++) {
                years.push(y);
            }

            this.years = years;
            this.year = this.year || currYear;
            this.month = this.month || currDate.getMonth();
            this.day = this.day || currDate.getDate();
        },

        // Generates an array with available days for a given month and year
        daysInMonth: function(month, year) {
            var lastDay = new Date(year, month + 1, -1).getDate();
            var days = [];
            for (var d = 1; d <= lastDay; d++) {
                days.push(d);
            }
            return days;
        },

        /**
         * @method getDate
         * Returns a `Date` object initialized with the selected year, month and day
         */
        getDate: function() {
            return new Date(this.year, this.month, this.day);
        }

    });
})();
</script>

</polymer-element>
